<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=GBK" />
<title>struts2</title>
<style type="text/css">
.c{cursor:hand}
.m{color:blue}
.t{color:#990000}
.e{margin-left:1em;text-indent:-1em;margin-right:1em}
.b{color:red;font-family:'Courier New';font-weight:bold;text-decoration:none}
</style>
</head>

<body>
<div><h2>webservice axis</h2></div>
<ul style="list-style:decimal">
<li>
import org.apache.axis.client.Call;<br/>
import org.apache.axis.client.Service;
<br/><br/>
<br/>
String url = &quot;http://10.32.182.210:8091/csp-magent-client/madapterservices/c_weixin/UploadFile&quot;;<br />
//<span lang="zh-cn">方法名</span><br />
String action = &quot;transImg&quot;;<br />
try {<br />
&nbsp;&nbsp;&nbsp; //获得服务<br/>
<span lang="zh-cn">&nbsp;&nbsp;&nbsp; </span>Service service = new Service();<br />
&nbsp;&nbsp;&nbsp; //获得接口调用<br/>
<span lang="zh-cn">&nbsp;&nbsp;&nbsp; </span>Call call = (Call) 
service.createCall();<br />
&nbsp;&nbsp;&nbsp; //接口目标地址<br/>
<span lang="zh-cn">&nbsp;&nbsp;&nbsp; </span>call.setTargetEndpointAddress(url);<br />
&nbsp;&nbsp;&nbsp;
//<span lang="zh-cn">接口调用的方法</span><br/>
<span lang="zh-cn">&nbsp;&nbsp;&nbsp; </span>call.setOperation(action);<br />
&nbsp;&nbsp;&nbsp; //超时属性<br />
<span lang="zh-cn">&nbsp;&nbsp;&nbsp; </span>call.setTimeout(new Integer(5000));<br />
<span lang="zh-cn">&nbsp;&nbsp;&nbsp; </span>//有几个参数增加几次 在call.invoke(new 
Object[] { imgStr,fileName }); 对应几个<br />
<span lang="zh-cn">&nbsp;&nbsp;&nbsp; </span>call.addParameter(&quot;xml&quot;,
<span lang="zh-cn">&nbsp;</span>org.apache.axis.encoding.XMLType.XSD_STRING,<span lang="zh-cn"> </span>javax.xml.rpc.ParameterMode.IN);<br />
<span lang="zh-cn">&nbsp;&nbsp;&nbsp; </span>call.addParameter(&quot;xml&quot;,
org.apache.axis.encoding.XMLType.XSD_STRING,<span lang="zh-cn"> </span>javax.xml.rpc.ParameterMode.IN);<br />
&nbsp;&nbsp;&nbsp; // 设置返回类型<br/>
<span lang="zh-cn">&nbsp;&nbsp;&nbsp; </span>call.setReturnType(org.apache.axis.encoding.XMLType.XSD_INT);<br />
&nbsp;&nbsp;&nbsp; //调用 反射 参数 获得返回值<br />

<span lang="zh-cn">&nbsp;&nbsp;&nbsp; </span>Integer outString = (Integer) 
call.invoke(new Object[] { imgStr,fileName });<br />
} catch (Exception e) {<br />
<span lang="zh-cn">&nbsp;&nbsp;&nbsp; </span>e.printStackTrace();<br />
}</li>
</ul>





</body>

</html>
